/*
 * @class InterconnectedInputs ~jquery-interconnected-inputs~ (https://github.com/cubeeq/jquery-interconnected-inputs)
 * @author Developped by cubeeq (https://github.com/cubeeq)
 * @license Licensed under MIT (https://github.com/cubeeq/jquery-interconnected-inputs/blob/master/LICENSE)
 */
class InterconnectedInputs{dateFrom;dateStart;dateEnd;coreFormat="Y/M/D";message={default:"Function getMessage must have one parameter.",jquery:"Require: https://jquery.com.",datepicker:"Require: https://jqueryui.com/datepicker",momentjs:"Require: https://momentjs.com.",jqueryinst:"The input value is not an jQuery object."};constructor(e){"object"!=typeof(e="object"!=typeof e?Object.create(null):e).from&&(e.from=Object.create(null)),"object"!=typeof e.to&&(e.to=Object.create(null)),this.disableDaysFormat=void 0!==e.disableDaysFormat?e.disableDaysFormat:"YYYY-MM-DD",this.disableDays=void 0!==e.disableDays?e.disableDays:[],this.inputFrom=e.from.input,this.inputTo=e.to.input,this.fromDaysDiff=void 0!==e.from.daysDiff?e.from.daysDiff:0,this.toDaysDiff=void 0!==e.to.daysDiff?e.to.daysDiff:0,this.datepicker=e.datepicker,this.datepickerFrom=e.from.datepicker,this.datepickerTo=e.to.datepicker}init(){const a=this;var e=a.getDatepicker();const t=a.getInputFrom(),s=a.getInputTo();a.checkDependencies(),a.checkJQueryObj(t),a.checkJQueryObj(s);var r={beforeShowDay:function(e){return[a.compareDisable(e)]},onSelect:function(e,t){var r=a.getFromDaysDiff(),t=a.createDate(t.selectedYear,t.selectedMonth,t.selectedDay);a.setDateFrom(a.calcDaysDiff(t,r)),a.clearInput(s)}},o={beforeShowDay:function(e){var t=a.getDateFrom();let r=!0;return a.setDateStart(t),t&&a.setDateEnd(a.breakDay()),t&&null!==a.getDateEnd()&&(r=e<a.getDateEnd()),t||(r=a.compareDisable(e)),e<t&&(r=!1),[r]}};a.clearInput(t),a.clearInput(s),r=a.pushObj(r,e),o=a.pushObj(o,e),r=a.pushObj(r,a.getDatepickerFrom()),o=a.pushObj(o,a.getDatepickerTo()),t.datepicker(r),s.datepicker(o)}checkJQueryObj(e){if(e instanceof jQuery==!1)throw new Error(this.getMessage("jqueryinst"))}checkDependencies(){if("function"!=typeof $)throw new Error(this.getMessage("jquery"));if("function"!=typeof jQuery)throw new Error(this.getMessage("jquery"));if("object"!=typeof $.datepicker)throw new Error(this.getMessage("datepicker"));if("function"!=typeof moment)throw new Error(this.getMessage("momentjs"))}compareDisable(e){e=this.getCoreFormatedDate(e);return-1==this.formatedDisableDays().indexOf(e)}pushObj(e,t){for(const r in t)e[r]=t[r];return e}breakDay(){var e=this.formatedDisableDays(),t=new Date(this.getDateStart());for(const r in e){const a=new Date(e[r]);if(t<=a)return a.setDate(a.getDate()+this.getToDaysDiff()),a}return!1}formatedDisableDays(){var e=this.getDisableDays();let t=[];for(const r in e)t[r]=this.convertDisableDaysToCoreFormat(e[r]);return t.sort()}clearInput(e){e.val("")}getCoreFormatedDate(e){return moment(e).format(this.getCoreFormat())}convertDisableDaysToCoreFormat(e){return moment(e,this.getDisableDaysFormat()).format(this.getCoreFormat())}calcDaysDiff(e,t){return e.setDate(e.getDate()+t)}createDate(e,t,r){return new Date(e,t,r)}getDateStart(){return this.dateStart}getDateEnd(){return this.dateEnd}getDateFrom(){return this.dateFrom}getDisableDays(){return this.disableDays}getDisableDaysFormat(){return this.disableDaysFormat}getInputFrom(){return this.inputFrom}getInputTo(){return this.inputTo}getFromDaysDiff(){return this.fromDaysDiff}getToDaysDiff(){return this.toDaysDiff}getDatepicker(){return this.datepicker}getDatepickerFrom(){return this.datepickerFrom}getDatepickerTo(){return this.datepickerTo}getCoreFormat(){return this.coreFormat}getMessage(e){return this.message[e]}setDateStart(e){this.dateStart=e||new Date}setDateEnd(e){this.dateEnd=e||null}setDateFrom(e){this.dateFrom=e||null}}